# Network_type_reachability

This library is based on and inspired by the library "[flutter_reachability](https://pub.dev/packages/flutter_reachability)"

This library uses the following dependencies

[permission_handler: 9.2.0](https://pub.dev/packages/permission_handler/versions/9.2.0)<br>
[dart_ping: ^6.1.2](https://pub.dev/packages/dart_ping)<br>
[dart_ping_ios: ^1.1.0](https://pub.dev/packages/dart_ping_ios)

Next, the necessary configurations for the correct operation of "Network_type_reachability" will be shown, but it is recommended to take a look at the original packages.

***

To use the version prior to NullSafety use the version [1.2.1](https://pub.dev/packages/network_type_reachability/versions/1.2.1)

***
## Permission_handler settings

<details close>
<summary>Android</summary>


**Upgrade pre 1.12 Android projects**

Since version 4.4.0 this plugin is implemented using the Flutter 1.12 Android plugin APIs. Unfortunately this means App developers also need to migrate their Apps to support the new Android infrastructure. You can do so by following the [Upgrading pre 1.12 Android projects](https://github.com/flutter/flutter/wiki/Upgrading-pre-1.12-Android-projects) migration guide. Failing to do so might result in unexpected behaviour. Most common known error is the permission\_handler not returning after calling the `.request()` method on a permission.

**AndroidX**

As of version 3.1.0 the permission\_handler plugin switched to the AndroidX version of the Android Support Libraries. This means you need to make sure your Android project is also upgraded to support AndroidX. Detailed instructions can be found [here](https://flutter.dev/docs/development/packages-and-plugins/androidx-compatibility).

The TL;DR version is:

1.  Add the following to your "gradle.properties" file:

    android.useAndroidX=true
    android.enableJetifier=true
    

copied to clipboard

1.  Make sure you set the `compileSdkVersion` in your "android/app/build.gradle" file to 31:

    android {
      compileSdkVersion 31
      ...
    }
    

copied to clipboard

1.  Make sure you replace all the `android.` dependencies to their AndroidX counterparts (a full list can be found [here](https://developer.android.com/jetpack/androidx/migrate)).

Add permissions to your `AndroidManifest.xml` file. There's a `debug`, `main` and `profile` version which are chosen depending on how you start your app. In general, it's sufficient to add permission only to the `main` version. [Here](https://github.com/Baseflow/flutter-permission-handler/blob/master/permission_handler/example/android/app/src/main/AndroidManifest.xml)'s an example `AndroidManifest.xml` with a complete list of all possible permissions.
</details>

<details close>
<summary>Ios</summary>

Add permission to your `Info.plist` file. [Here](https://github.com/Baseflow/flutter-permission-handler/blob/master/permission_handler/example/ios/Runner/Info.plist)'s an example `Info.plist` with a complete list of all possible permissions.

> IMPORTANT: You will have to include all permission options when you want to submit your App. This is because the `permission_handler` plugin touches all different SDKs and because the static code analyser (run by Apple upon App submission) detects this and will assert if it cannot find a matching permission option in the `Info.plist`. More information about this can be found [here](https://github.com/Baseflow/flutter-permission-handler/issues/26).

The permission\_handler plugin use [macros](https://github.com/Baseflow/flutter-permission-handler/blob/master/permission_handler/ios/Classes/PermissionHandlerEnums.h) to control whether a permission is enabled.

You must list permission you want to use in your application :

1.  Add the following to your `Podfile` file:
    
        post_install do |installer|
          installer.pods_project.targets.each do |target|
            target.build_configurations.each do |config|
              ... # Here are some configurations automatically generated by flutter
        
              # You can enable the permissions needed here. For example to enable camera
              # permission, just remove the `#` character in front so it looks like this:
              #
              # ## dart: PermissionGroup.camera
              # 'PERMISSION_CAMERA=1'
              #
              #  Preprocessor definitions can be found in: https://github.com/Baseflow/flutter-permission-handler/blob/master/permission_handler/ios/Classes/PermissionHandlerEnums.h
              config.build_settings['GCC_PREPROCESSOR_DEFINITIONS'] ||= [
                '$(inherited)',
        
                ## dart: PermissionGroup.calendar
                # 'PERMISSION_EVENTS=1',
        
                ## dart: PermissionGroup.reminders
                # 'PERMISSION_REMINDERS=1',
        
                ## dart: PermissionGroup.contacts
                # 'PERMISSION_CONTACTS=1',
        
                ## dart: PermissionGroup.camera
                # 'PERMISSION_CAMERA=1',
        
                ## dart: PermissionGroup.microphone
                # 'PERMISSION_MICROPHONE=1',
        
                ## dart: PermissionGroup.speech
                # 'PERMISSION_SPEECH_RECOGNIZER=1',
        
                ## dart: PermissionGroup.photos
                # 'PERMISSION_PHOTOS=1',
        
                ## dart: [PermissionGroup.location, PermissionGroup.locationAlways, PermissionGroup.locationWhenInUse]
                # 'PERMISSION_LOCATION=1',
        
                ## dart: PermissionGroup.notification
                # 'PERMISSION_NOTIFICATIONS=1',
        
                ## dart: PermissionGroup.mediaLibrary
                # 'PERMISSION_MEDIA_LIBRARY=1',
        
                ## dart: PermissionGroup.sensors
                # 'PERMISSION_SENSORS=1',   
        
                ## dart: PermissionGroup.bluetooth
                # 'PERMISSION_BLUETOOTH=1',
        
                ## dart: PermissionGroup.appTrackingTransparency
                # 'PERMISSION_APP_TRACKING_TRANSPARENCY=1',
        
                ## dart: PermissionGroup.criticalAlerts
                # 'PERMISSION_CRITICAL_ALERTS=1'
              ]
        
            end
          end
        end
        
    
    copied to clipboard
    
2.  Remove the `#` character in front of the permission you do want to use. For example if you need access to the calendar make sure the code looks like this:
    
                ## dart: PermissionGroup.calendar
                'PERMISSION_EVENTS=1',
        
    
    copied to clipboard
    
3.  Delete the corresponding permission description in `Info.plist` e.g. when you don't need camera permission, just delete 'NSCameraUsageDescription' The following lists the relationship between `Permission` and `The key of Info.plist`:
    
    Permission
    
    Info.plist
    
    Macro
    
    PermissionGroup.calendar
    
    NSCalendarsUsageDescription
    
    PERMISSION\_EVENTS
    
    PermissionGroup.reminders
    
    NSRemindersUsageDescription
    
    PERMISSION\_REMINDERS
    
    PermissionGroup.contacts
    
    NSContactsUsageDescription
    
    PERMISSION\_CONTACTS
    
    PermissionGroup.camera
    
    NSCameraUsageDescription
    
    PERMISSION\_CAMERA
    
    PermissionGroup.microphone
    
    NSMicrophoneUsageDescription
    
    PERMISSION\_MICROPHONE
    
    PermissionGroup.speech
    
    NSSpeechRecognitionUsageDescription
    
    PERMISSION\_SPEECH\_RECOGNIZER
    
    PermissionGroup.photos
    
    NSPhotoLibraryUsageDescription
    
    PERMISSION\_PHOTOS
    
    PermissionGroup.location, PermissionGroup.locationAlways, PermissionGroup.locationWhenInUse
    
    NSLocationUsageDescription, NSLocationAlwaysAndWhenInUseUsageDescription, NSLocationWhenInUseUsageDescription
    
    PERMISSION\_LOCATION
    
    PermissionGroup.notification
    
    PermissionGroupNotification
    
    PERMISSION\_NOTIFICATIONS
    
    PermissionGroup.mediaLibrary
    
    NSAppleMusicUsageDescription, kTCCServiceMediaLibrary
    
    PERMISSION\_MEDIA\_LIBRARY
    
    PermissionGroup.sensors
    
    NSMotionUsageDescription
    
    PERMISSION\_SENSORS
    
    PermissionGroup.bluetooth
    
    NSBluetoothAlwaysUsageDescription, NSBluetoothPeripheralUsageDescription
    
    PERMISSION\_BLUETOOTH
    
    PermissionGroup.appTrackingTransparency
    
    NSUserTrackingUsageDescription
    
    PERMISSION\_APP\_TRACKING\_TRANSPARENCY
    
    PermissionGroup.criticalAlerts
    
    PermissionGroupCriticalAlerts
    
    PERMISSION\_CRITICAL\_ALERTS
    
4.  Clean & Rebuild
</details>

***


This plugin is suitable for iOS and Android. This plugin allows Flutter apps to detect network changes. You can know the detailed mobile network types, such as 2G, 3G, 4G, 5G.
This plugin also allows you to see the status of internet connection

## Use

#### Example

![alt text](https://media.giphy.com/media/Q38gPMCyFWWJZVj8g0/giphy-downsized-large.gif "Network_type_reachability")


1. get NETWORK_TYPE
**
Note: Android must dynamically obtain the READ_PHONE_STATE permission to judge 2G/3G/4G/5G**
```dart


  String _networkTypeStatic = 'Unknown';

  //widget
  Column(
    mainAxisAlignment: MainAxisAlignment.spaceAround,
    children: [
      const Text('NETWORK_TYPE : '),
      Text(
        _networkTypeStatic,
        style: const TextStyle(fontWeight: FontWeight.bold),
      ),
      TextButton(
        onPressed: () {
          _getCurrentNetworkStatus();
        },
        child: const Text('Get-Data'),
        style: ButtonStyle(
          backgroundColor: MaterialStateProperty.all(
              const Color.fromARGB(255, 162, 229, 188)),
        ),
      )
    ],
  ),

  //function

  _getCurrentNetworkStatus() async {
    if (Platform.isAndroid) {
      await NetworkTypeReachability().getPermisionsAndroid;
    }
    NetworkStatus status =
        await NetworkTypeReachability().currentNetworkStatus();
    switch (status) {
      case NetworkStatus.unreachable:
      //unreachable
      case NetworkStatus.wifi:
      //wifi
      case NetworkStatus.mobile2G:
      //2g
      case NetworkStatus.moblie3G:
      //3g
      case NetworkStatus.moblie4G:
      //4g
      case NetworkStatus.moblie5G:
      //5h
      case NetworkStatus.otherMoblie:
      //other
    }
    setState(() {
      _networkTypeStatic = status.toString();
    });
  }
    
```
2. You can also listen for NETWORK_TYPE changes by subscribing to the stream exposed by Network_type_reachability plugin
```dart

  String _networkTypeSuscription = 'Unknown';
  StreamSubscription<NetworkStatus> subscriptionNetworkType;

  @override
  void initState() {
    super.initState();
    _listenNetworkStatus();
  }

  @override
  void dispose() {
    super.dispose();
    subscriptionNetworkType.cancel();
  }

  _listenNetworkStatus() async {
    if (Platform.isAndroid) {
      await NetworkTypeReachability().getPermisionsAndroid;
    }
    subscriptionNetworkType =
        NetworkTypeReachability().onNetworkStateChanged.listen((event) {
      setState(() {
        _networkTypeSuscription = "$event";
      });
    });
  }


  // Widget
  Column(
    mainAxisAlignment: MainAxisAlignment.center,
    children: [
      const Text('NETWORK_TYPE Suscription: '),
      Text(
        _networkTypeSuscription,
        style: const TextStyle(fontWeight: FontWeight.bold),
      ),
    ],
  ),
```
3. get Status Internet Conection 

```dart

  String connectivityInternetStatic = 'Unknown';

  // Widget
  Column(
    mainAxisAlignment: MainAxisAlignment.spaceAround,
    children: [
      const Text('Status Internet Conection : '),
      Text(
        connectivityInternetStatic,
        style: const TextStyle(fontWeight: FontWeight.bold),
      ),
      TextButton(
        onPressed: () async {
          print('#=======> cargando');
          connectivityInternetStatic = 'loading...';
          setState(() {});
          InternetStatusConnection data =
              await NetworkTypeReachability()
                  .getInternetStatusConnection();
          print(data);
          print('#=======> finalizando');

          connectivityInternetStatic = data.toString();
          setState(() {});
        },
        child: const Text('Get-Data'),
        style: ButtonStyle(
          backgroundColor: MaterialStateProperty.all(
              const Color.fromARGB(255, 162, 229, 188)),
        ),
      )
    ],
  ),
    
```
4. get Status Internet Conection Suscription
NOTE: It is recommended not to keep the listening state constantly since behind what it does is load the google.com page and this would constantly consume many megabytes of internet over time
```dart

  String connectivityInternetSuscription = 'Unknown';
  StreamSubscription<InternetStatusConnection> subscriptionInternetConnection;

  @override
  void initState() {
    super.initState();
    _listenInternetConnection();
  }

  @override
  void dispose() {
    super.dispose();
    subscriptionInternetConnection.cancel();
    NetworkTypeReachability().listenInternetConnection = false;
  }


  // Widget
  Column(
    mainAxisAlignment: MainAxisAlignment.center,
    children: [
      const Text('Status Internet Conection : '),
      Text(
        connectivityInternetSuscription,
        style: const TextStyle(fontWeight: FontWeight.bold),
      ),
    ],
  )

```

## Getting Started

This project is a starting point for a Flutter
[plug-in package](https://flutter.dev/developing-packages/),
a specialized package that includes platform-specific implementation code for
Android and/or iOS.

For help getting started with Flutter, view our
[online documentation](https://flutter.dev/docs), which offers tutorials,
samples, guidance on mobile development, and a full API reference.
